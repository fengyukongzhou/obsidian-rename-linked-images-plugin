# Obsidian Rename Linked Images Plugin

一个用于批量重命名当前笔记中所有图片链接的 Obsidian 插件，支持统一的命名规则。

## 功能特性

- 🔄 **批量重命名**：一次性重命名当前笔记中的所有图片文件
- 📝 **统一命名**：使用自定义前缀、日期和序号的统一命名格式
- 🔗 **链接更新**：自动更新笔记中的图片链接引用
- 🎨 **格式支持**：支持 Obsidian wiki 链接 `![[图片]]` 和 Markdown 链接 `![](图片)`
- ⚙️ **灵活配置**：支持多种日期格式、序号位数和链接格式设置

## 安装方法

1. 下载此仓库的所有文件
2. 在你的 Obsidian vault 中创建目录：`.obsidian/plugins/rename-linked-images/`
3. 将所有文件复制到该目录
4. 重启 Obsidian 或重新加载插件（设置 → 社区插件 → 重新加载）

## 使用方法

1. 打开包含图片的 Markdown 笔记
2. 使用命令面板（Ctrl/Cmd + P）搜索"重命名当前笔记的关联图片"
3. 在弹出的对话框中输入图片前缀（如：zd、img、pic）
4. 确认重命名操作

## 命名规则

插件生成的文件名格式：`前缀 + 日期 + 序号 + 扩展名`

示例：`zd1130-001.png`

- **前缀**：用户自定义（如 zd、img、pic）
- **日期**：可选，支持多种格式（MMDD、DDMM、YYMMDD）
- **序号**：自动递增，可设置起始值和位数
- **扩展名**：保留原文件扩展名

## 设置选项

在插件设置中可以配置：

- **默认前缀**：图片文件名的前缀
- **包含日期**：是否在文件名中包含日期
- **日期格式**：月日(MMDD)、日月(DDMM)、年月日(YYMMDD)
- **序号位数**：序号的位数（1-5位）
- **起始序号**：重命名的起始序号
- **链接格式**：Wiki 链接或 Markdown 链接

## 已知问题

### 🐛 光标消失问题
- **问题描述**：运行插件后，编辑器光标会消失，需要切换一次窗口才能恢复
- **临时解决方案**：按 Alt+Tab 切换到其他窗口，再切换回 Obsidian
- **状态**：待修复

## 技术实现

### 核心算法
1. **图片链接提取**：使用正则表达式识别 `![[图片]]` 和 `![](图片)` 格式的链接
2. **命名映射生成**：根据配置规则生成旧文件名到新文件名的映射关系
3. **文件重命名**：使用 Obsidian API 重命名实际文件
4. **内容更新**：采用单次遍历替换策略更新笔记中的链接引用

### 关键特性
- **安全性**：检查文件存在性，避免覆盖已有文件
- **容错性**：处理各种异常情况，提供友好提示
- **性能优化**：单次遍历替换，避免重复操作导致的污染问题

## 开发计划

- [ ] 修复光标消失问题
- [ ] 添加批量撤销功能
- [ ] 支持自定义命名模板
- [ ] 添加图片预览功能
- [ ] 支持子目录中的图片

## 贡献指南

欢迎提交 Issue 和 Pull Request！

1. Fork 此仓库
2. 创建功能分支：`git checkout -b feature/新功能`
3. 提交更改：`git commit -m 'feat-添加新功能'`
4. 推送分支：`git push origin feature/新功能`
5. 创建 Pull Request

## 许可证

MIT License

## 更新日志

### v1.0.0 (2025-11-30)
- ✨ 初始版本发布
- ✅ 支持批量重命名图片链接
- ✅ 支持自定义命名规则
- ✅ 支持多种链接格式
- 🐛 存在光标消失的已知问题

---

**作者**：iFlow CLI  
**仓库**：https://github.com/fengyukongzhou/obsidian-rename-linked-images-plugin